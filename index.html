<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Roadmap de Produtos - Visual 2.0</title>
  <style>
    :root {
      --bg: #0e1a2b;
      --text: #e1e8f0;
      --linha: #2a3b57;
      --borda: #3f4d68;
      --categorias: #6ec1e4, #f6c979, #82d173, #ff92b1;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: 'Inter', sans-serif;
      background-color: var(--bg);
      color: var(--text);
      padding: 24px;
    }

    h1 {
      text-align: center;
      margin-bottom: 32px;
      font-size: 28px;
    }

    .filtros {
      display: flex;
      justify-content: center;
      gap: 16px;
      margin-bottom: 24px;
    }

    select {
      padding: 6px 12px;
      font-size: 14px;
      border-radius: 6px;
      border: none;
      background-color: #1c2c45;
      color: var(--text);
    }

    .grid {
      display: grid;
      grid-template-columns: 180px repeat(36, 1fr);
      border-top: 1px solid var(--borda);
      position: relative;
    }

    .linha {
      display: contents;
    }

    .categoria {
      background-color: var(--linha);
      padding: 12px;
      font-weight: 600;
      border-bottom: 1px solid var(--borda);
    }

    .celula {
      height: 40px;
      border-left: 1px solid var(--borda);
      border-bottom: 1px solid var(--borda);
      position: relative;
    }

    .barra {
      position: absolute;
      height: 30px;
      border-radius: 6px;
      padding: 4px 8px;
      font-size: 12px;
      font-weight: 500;
      white-space: nowrap;
      color: #fff;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .meses {
      display: contents;
    }

    .mes-label {
      text-align: center;
      font-size: 12px;
      background-color: #1b2c47;
      padding: 4px;
      border-left: 1px solid var(--borda);
      border-bottom: 1px solid var(--borda);
    }
  </style>
</head>
<body>
  <h1>Roadmap de Produtos - Plataforma (Visual 2.0)</h1>
  <div class="filtros">
    <label>Categoria:
      <select id="filtroCategoria">
        <option value="">Todas</option>
      </select>
    </label>
    <label>Ano:
      <select id="filtroAno">
        <option value="">Todos</option>
      </select>
    </label>
  </div>
  <div id="roadmap" class="grid"></div>

  <script>
    const entregas = [
      {Entrega: "Múltiplas adquirentes", Fase: "Discovery", Inicio: "2024-01", Fim: "2025-12"},
      {Entrega: "Pix automático", Fase: "Discovery", Inicio: "2024-01", Fim: "2025-06"},
      {Entrega: "Unificação Navision", Fase: "Discovery", Inicio: "2025-04", Fim: "2025-12"},
      {Entrega: "Unificação Salesforce", Fase: "Discovery", Inicio: "2025-04", Fim: "2025-12"},
      {Entrega: "FCV Salesforce", Fase: "Discovery", Inicio: "2025-04", Fim: "2025-06"},
      {Entrega: "Adoção B2C", Fase: "Refinamento", Inicio: "2024-01", Fim: "2025-12"},
      {Entrega: "Backoffice Plataforma", Fase: "Refinamento", Inicio: "2024-01", Fim: "2025-12"},
      {Entrega: "Projeto redução de perdas", Fase: "Refinamento", Inicio: "2024-01", Fim: "2025-09"},
      {Entrega: "Redução de cancelamentos B2B", Fase: "Refinamento", Inicio: "2025-04", Fim: "2025-09"},
      {Entrega: "Analytics B2C", Fase: "Finalizado", Inicio: "2025-03", Fim: "2025-03"},
      {Entrega: "Adoção B2B", Fase: "Finalizado", Inicio: "2024-01", Fim: "2025-03"},
      {Entrega: "PCI 2025", Fase: "Finalizado", Inicio: "2025-04", Fim: "2025-06"},
    ];

    const categorias = [...new Set(entregas.map(e => e.Fase))];
    const cores = ["#6ec1e4", "#f6c979", "#82d173", "#ff92b1"];

    const roadmap = document.getElementById("roadmap");
    const filtroCategoria = document.getElementById("filtroCategoria");
    const filtroAno = document.getElementById("filtroAno");

    categorias.forEach(c => {
      const opt = document.createElement("option");
      opt.value = c;
      opt.textContent = c;
      filtroCategoria.appendChild(opt);
    });

    const anos = [2023, 2024, 2025];
    anos.forEach(a => {
      const opt = document.createElement("option");
      opt.value = a;
      opt.textContent = a;
      filtroAno.appendChild(opt);
    });

    function gerarGrade() {
      roadmap.innerHTML = "";
      // Header meses
      roadmap.innerHTML += `<div class='categoria'></div>`;
      for (let a = 2023; a <= 2025; a++) {
        for (let m = 0; m < 12; m++) {
          const nomeMes = new Date(a, m).toLocaleString('pt-BR', { month: 'short' });
          roadmap.innerHTML += `<div class='mes-label'>${nomeMes}/${a}</div>`;
        }
      }

      let corIndex = 0;
      categorias.forEach(cat => {
        const cor = cores[corIndex % cores.length];
        corIndex++;
        const entregasCat = entregas.filter(e => e.Fase === cat &&
          (!filtroCategoria.value || filtroCategoria.value === cat) &&
          (!filtroAno.value || e.Inicio.startsWith(filtroAno.value) || e.Fim.startsWith(filtroAno.value)));

        entregasCat.forEach(e => {
          roadmap.innerHTML += `<div class='categoria'>${cat}</div>`;
          for (let i = 0; i < 36; i++) roadmap.innerHTML += `<div class='celula'></div>`;

          const indexInicio = (parseInt(e.Inicio.slice(0, 4)) - 2023) * 12 + (parseInt(e.Inicio.slice(5, 7)) - 1);
          const indexFim = (parseInt(e.Fim.slice(0, 4)) - 2023) * 12 + (parseInt(e.Fim.slice(5, 7)) - 1);

          const pos = (indexInicio + 1) * (100 / 36);
          const largura = ((indexFim - indexInicio + 1) * (100 / 36));

          const barra = document.createElement("div");
          barra.className = "barra";
          barra.textContent = e.Entrega;
          barra.style.background = cor;
          barra.style.left = `calc(${pos}% + 180px)`;
          barra.style.top = `-${36}px`;
          barra.style.width = `calc(${largura}% - 4px)`;
          barra.style.position = "absolute";
          roadmap.appendChild(barra);
        });
      });
    }

    filtroCategoria.addEventListener("change", gerarGrade);
    filtroAno.addEventListener("change", gerarGrade);

    gerarGrade();
  </script>
</body>
</html>
